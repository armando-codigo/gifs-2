"use strict";(self.webpackChunkgifs_app=self.webpackChunkgifs_app||[]).push([[435],{435:(V,h,a)=>{a.r(h),a.d(h,{GifsModule:()=>j});var c=a(814),m=a(276),e=a(946);let _=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[c.ez,m.Bz]}),s})();var p=a(862),T=a(398),C=a(397);let d=(()=>{class s{constructor(t){this.http=t,this.apiUrl="https://api.giphy.com/v1/gifs",this.apiEndpoint="search",this.apiKey="Q3saNpHHGG53jmwlwTLDgsp77uJGtGMP",this.apiLimit=10,this.termStack=[],localStorage.getItem("stack")&&(this.termStack=JSON.parse(localStorage.getItem("stack")))}getGifsRequest(t){const i=`${this.apiUrl}/${this.apiEndpoint}`;this.setSessionStorage(t),this.setTermStack(t);let r=this.clearTerm(t);const o=(new p.LE).set("api_key",this.apiKey).set("q",r).set("limit",this.apiLimit);return this.getObservable(i,o)}getObservable(t,i){return this.http.get(t,{params:i}).pipe((0,T.U)(r=>r.data),(0,C.b)(r=>{this.setLocalStorage(r)}))}clearTerm(t){const i=RegExp(". ,-/()!?\xa1\xbf\xb4");return t.replace(i,"%20")}setLocalStorage(t){localStorage.setItem("gifs",JSON.stringify(t)),localStorage.setItem("stack",JSON.stringify(this.termStack))}setSessionStorage(t){sessionStorage.setItem("term",t)}getLocalStorage(){return localStorage.getItem("gifs")?JSON.parse(localStorage.getItem("gifs")):[]}getSessionStorage(){return sessionStorage.getItem("term")?sessionStorage.getItem("term"):""}setTermStack(t){if(0==this.termStack.length)this.termStack.push(t);else if(this.termStack.includes(t)){const i=[...this.termStack].splice(0,this.apiLimit-1).filter(r=>r!=t);this.termStack=[t,...i]}else{const i=[...this.termStack].splice(0,this.apiLimit-1);this.termStack=[t,...i]}}get getTermStack(){return this.termStack}clearStorage(){localStorage.removeItem("stack"),localStorage.removeItem("gifs"),sessionStorage.removeItem("term"),this.termStack=[]}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(p.eN))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var G=a(645),x=a(394);class L extends x.w0{constructor(n,t){super()}schedule(n,t=0){return this}}const g={setInterval(s,n,...t){const{delegate:i}=g;return i?.setInterval?i.setInterval(s,n,...t):setInterval(s,n,...t)},clearInterval(s){const{delegate:n}=g;return(n?.clearInterval||clearInterval)(s)},delegate:void 0};var b=a(39);const f={now:()=>(f.delegate||Date).now(),delegate:void 0};class u{constructor(n,t=u.now){this.schedulerActionCtor=n,this.now=t}schedule(n,t=0,i){return new this.schedulerActionCtor(this,n).schedule(i,t)}}u.now=f.now;const A=new class k extends u{constructor(n,t=u.now){super(n,t),this.actions=[],this._active=!1}flush(n){const{actions:t}=this;if(this._active)return void t.push(n);let i;this._active=!0;do{if(i=n.execute(n.state,n.delay))break}while(n=t.shift());if(this._active=!1,i){for(;n=t.shift();)n.unsubscribe();throw i}}}(class w extends L{constructor(n,t){super(n,t),this.scheduler=n,this.work=t,this.pending=!1}schedule(n,t=0){var i;if(this.closed)return this;this.state=n;const r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(o,this.id,t),this}requestAsyncId(n,t,i=0){return g.setInterval(n.flush.bind(n,this),i)}recycleAsyncId(n,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&g.clearInterval(t)}execute(n,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(n,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,t){let r,i=!1;try{this.work(n)}catch(o){i=!0,r=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:n,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,(0,b.P)(i,this),null!=n&&(this.id=this.recycleAsyncId(t,n,null)),this.delay=null,super.unsubscribe()}}});var E=a(360),Z=a(251);const U=["tag"];let B=(()=>{class s{constructor(){this.tagEmitter=new e.vpe}set setTerm(t){t&&(this.term=t)}get getTerm(){return this.term?this.term:""}sendTag(t){this.tagEmitter.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["shared-tags"]],viewQuery:function(t,i){if(1&t&&e.Gf(U,5),2&t){let r;e.iGM(r=e.CRH())&&(i.tagElement=r.first)}},inputs:{setTerm:"setTerm"},outputs:{tagEmitter:"tagEmitter"},decls:3,vars:1,consts:[["type","button",1,"btn","btn-secondary",3,"click"],["tag",""]],template:function(t,i){1&t&&(e.TgZ(0,"button",0,1),e.NdJ("click",function(){return i.sendTag(i.getTerm)}),e._uU(2),e.qZA()),2&t&&(e.xp6(2),e.hij(" ",i.getTerm,"\n"))},encapsulation:2}),s})();const F=["searchBox"];function N(s,n){if(1&s){const t=e.EpF();e.TgZ(0,"shared-tags",7),e.NdJ("tagEmitter",function(r){e.CHM(t);const o=e.oxw(2);return e.KtG(o.tagGetter(r))}),e.qZA()}2&s&&e.Q6J("setTerm",n.$implicit)}function O(s,n){if(1&s){const t=e.EpF();e.TgZ(0,"section",4),e.YNc(1,N,1,1,"shared-tags",5),e.TgZ(2,"button",6),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.clearHistory())}),e._uU(3," Remove Search History "),e.qZA()()}if(2&s){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.getTermStack)}}let Q=(()=>{class s{constructor(t){this.getGifsService=t,this.inputEmitter=new e.vpe,this.inputDebouncer=new G.x,this.inputValue=t.getSessionStorage()}ngOnInit(){this.inputSubscription=this.inputDebouncer.pipe(function J(s,n=A){return(0,E.e)((t,i)=>{let r=null,o=null,y=null;const I=()=>{if(r){r.unsubscribe(),r=null;const l=o;o=null,i.next(l)}};function K(){const l=y+s,v=n.now();if(v<l)return r=this.schedule(void 0,l-v),void i.add(r);I()}t.subscribe((0,Z.x)(i,l=>{o=l,y=n.now(),r||(r=n.schedule(K,s),i.add(r))},()=>{I(),i.complete()},void 0,()=>{o=r=null}))})}(1e3)).subscribe(t=>{this.inputEmitter.emit(t)})}ngOnDestroy(){this.inputSubscription?.unsubscribe()}inputEmitterFunc(){this.searchBoxInput.nativeElement.value&&(this.inputEmitter.emit(this.searchBoxInput?.nativeElement.value),this.searchBoxInput.nativeElement.value="")}get getTermStack(){return this.getGifsService.getTermStack}tagGetter(t){this.inputEmitter.emit(t)}clearHistory(){this.getGifsService.clearStorage()}inputDebounce(t){let i=t.target;return!!i.value&&(this.inputDebouncer?.next(i.value),!1)}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(d))},s.\u0275cmp=e.Xpm({type:s,selectors:[["shared-search-box"]],viewQuery:function(t,i){if(1&t&&e.Gf(F,5),2&t){let r;e.iGM(r=e.CRH())&&(i.searchBoxInput=r.first)}},outputs:{inputEmitter:"inputEmitter"},decls:5,vars:2,consts:[["type","text","name","search-box","id","search-box",1,"m-2",3,"value","keyup.enter","keyup"],["searchBox",""],["type","button",1,"m-2","btn","btn-primary",3,"click"],["class","w-100",4,"ngIf"],[1,"w-100"],[3,"setTerm","tagEmitter",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-warning",3,"click"],[3,"setTerm","tagEmitter"]],template:function(t,i){1&t&&(e.TgZ(0,"input",0,1),e.NdJ("keyup.enter",function(){return i.inputEmitterFunc()})("keyup",function(o){return i.inputDebounce(o)}),e.qZA(),e.TgZ(2,"button",2),e.NdJ("click",function(){return i.inputEmitterFunc()}),e._uU(3," Search\n"),e.qZA(),e.YNc(4,O,4,1,"section",3)),2&t&&(e.Q6J("value",i.inputValue),e.xp6(4),e.Q6J("ngIf",i.getTermStack.length>0))},dependencies:[c.sg,c.O5,B],encapsulation:2}),s})(),M=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["shared-loader"]],decls:3,vars:0,consts:[[1,"loader"],["src","assets/three-dots.svg","alt","Loading...","title","Loading...","width","40"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e._uU(1," Loading... "),e._UZ(2,"img",1),e.qZA())},styles:[".loader[_ngcontent-%COMP%]{position:fixed;bottom:24px;right:24px;padding:12px;background-color:#eee;border-radius:8px;font-size:1.2rem}"]}),s})();const S=function(s){return{display:s}};let z=(()=>{class s{constructor(){this.imgIsLoaded=!1,this.imgWidth=200}set setImgUrl(t){t&&(this.imgUrl=t)}set setImgTitle(t){t&&(this.imgTitle=t)}set setImgAlt(t){t&&(this.imgAlt=t)}get getImgUrl(){return this.imgUrl}get getImgTitle(){return this.imgTitle}get getImgAlt(){return this.imgAlt}get getImgWidth(){return this.imgWidth}get getImgLoadedStatus(){return this.imgIsLoaded}setImgLoadedStatus(){setTimeout(()=>{this.imgIsLoaded=!this.imgIsLoaded},100)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["shared-lazy-img"]],inputs:{setImgUrl:"setImgUrl",setImgTitle:"setImgTitle",setImgAlt:"setImgAlt"},decls:2,vars:11,consts:[[3,"src","alt","title","ngStyle","load"],["src","assets/three-dots.svg","alt","Loading...","title","Loading...","width","50",3,"ngStyle"]],template:function(t,i){1&t&&(e.TgZ(0,"img",0),e.NdJ("load",function(){return i.setImgLoadedStatus()}),e.qZA(),e._UZ(1,"img",1)),2&t&&(e.Udp("width",i.getImgWidth,"px"),e.Q6J("src",i.getImgUrl,e.LSH)("alt",i.getImgAlt)("title",i.getImgTitle)("ngStyle",e.VKq(7,S,i.imgIsLoaded?"":"none")),e.xp6(1),e.Q6J("ngStyle",e.VKq(9,S,i.imgIsLoaded?"none":"")))},dependencies:[c.PC],encapsulation:2}),s})(),D=(()=>{class s{set setGifData(t){t&&(this.gif=t)}get getGif(){return this.gif}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["gifs-list-item"]],inputs:{setGifData:"setGifData"},decls:5,vars:6,consts:[[1,"card","shadow-sm","p-2","mt-2"],[3,"setImgUrl","setImgAlt","setImgTitle"]],template:function(t,i){1&t&&(e.TgZ(0,"article",0),e._UZ(1,"shared-lazy-img",1),e.TgZ(2,"h3"),e._uU(3),e.ALo(4,"titlecase"),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("setImgUrl",i.getGif.images.fixed_height_downsampled.url)("setImgAlt",i.getGif.title)("setImgTitle",i.getGif.slug),e.xp6(2),e.Oqu(e.lcZ(4,4,i.getGif.title)))},dependencies:[z,c.rS],encapsulation:2}),s})();function P(s,n){1&s&&e._UZ(0,"gifs-list-item",2),2&s&&e.Q6J("setGifData",n.$implicit)}let H=(()=>{class s{set setGifs(t){0!=t.length&&(this.gifs=t)}get getGifs(){return this.gifs}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["gifs-list"]],inputs:{setGifs:"setGifs"},decls:2,vars:1,consts:[[1,"container","p-2"],[3,"setGifData",4,"ngFor","ngForOf"],[3,"setGifData"]],template:function(t,i){1&t&&(e.TgZ(0,"section",0),e.YNc(1,P,1,1,"gifs-list-item",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngForOf",i.getGifs))},dependencies:[c.sg,D],encapsulation:2}),s})();function R(s,n){if(1&s&&e._UZ(0,"gifs-list",3),2&s){const t=e.oxw();e.Q6J("setGifs",t.getGifs)}}function q(s,n){1&s&&e._UZ(0,"shared-loader")}const Y=[{path:"",component:(()=>{class s{constructor(t){this.getGifsService=t,this.showLoader=!1,this.gifs=this.getGifsService.getLocalStorage()}ngOnDestroy(){this.getSubscription?.unsubscribe()}inputGetter(t){this.showLoader=!0,this.getSubscription=this.getGifsService.getGifsRequest(t).subscribe(i=>{this.gifs=i,this.showLoader=!1})}get getGifs(){return this.gifs}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(d))},s.\u0275cmp=e.Xpm({type:s,selectors:[["gifs-search-page"]],decls:5,vars:2,consts:[[3,"inputEmitter"],[3,"setGifs",4,"ngIf"],[4,"ngIf"],[3,"setGifs"]],template:function(t,i){1&t&&(e.TgZ(0,"h1"),e._uU(1,"Pagina de busqueda"),e.qZA(),e.TgZ(2,"shared-search-box",0),e.NdJ("inputEmitter",function(o){return i.inputGetter(o)}),e.qZA(),e.YNc(3,R,1,1,"gifs-list",1),e.YNc(4,q,1,0,"shared-loader",2)),2&t&&(e.xp6(3),e.Q6J("ngIf",i.getGifs),e.xp6(1),e.Q6J("ngIf",i.showLoader))},dependencies:[c.O5,Q,M,H],encapsulation:2}),s})()}];let X=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[m.Bz.forChild(Y),m.Bz]}),s})(),j=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[c.ez,X,_]}),s})()}}]);